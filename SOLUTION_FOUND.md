# âœ… è§£å†³æ–¹æ¡ˆå·²æ‰¾åˆ°ï¼

**æ—¥æœŸ**: 2025-10-21  
**é—®é¢˜**: é”™è¯¯ `0x9de3392c`  
**æ ¹æœ¬åŸå› **: å‰ç«¯æ•°æ®æ ¼å¼é”™è¯¯  
**çŠ¶æ€**: âœ… å·²ä¿®å¤

---

## ğŸ” é—®é¢˜åˆ†æ

### é”™è¯¯ç—‡çŠ¶
```
åŠ æ³¨å¤±è´¥: The contract function "bet" reverted with the following signature:
0x9de3392c
```

### æ ¹æœ¬åŸå› 

**å‰ç«¯åœ¨è½¬æ¢åŠ å¯†æ•°æ®æ—¶ç ´åäº†æ•°æ®æ ¼å¼ï¼**

å‰ç«¯ä»£ç ï¼š
```typescript
// âŒ é”™è¯¯åšæ³•
const dataHex = ('0x' + Array.from(encrypted.data).map(b => b.toString(16).padStart(2, '0')).join('')) as `0x${string}`;
const proofHex = ('0x' + Array.from(encrypted.proof).map(b => b.toString(16).padStart(2, '0')).join('')) as `0x${string}`;
args: [BigInt(tableId), dataHex, proofHex]
```

### æ­£ç¡®åšæ³•

æ ¹æ® `dev.md` æ–‡æ¡£ï¼ˆç¬¬ 4045-4052 è¡Œï¼‰ï¼Œåº”è¯¥ç›´æ¥ä¼ é€’åŠ å¯†æ•°æ®ï¼Œä¸éœ€è¦è½¬æ¢ï¼š

```typescript
// âœ… æ­£ç¡®åšæ³•
const dataHandle = encrypted.data;  // ç›´æ¥ä½¿ç”¨ handles[0]
const proofBytes = encrypted.proof;  // ç›´æ¥ä½¿ç”¨ inputProof
args: [BigInt(tableId), dataHandle, proofBytes]
```

---

## ğŸ”§ ä¿®å¤å†…å®¹

### 1. ä¿®å¤ `Game.tsx` (åŠ æ³¨åŠŸèƒ½)

**æ–‡ä»¶**: `frontend/src/pages/Game.tsx` (ç¬¬ 331-363 è¡Œ)

**ä¿®æ”¹**:
- ç§»é™¤äº† hex å­—ç¬¦ä¸²è½¬æ¢
- ç›´æ¥ä¼ é€’ `encrypted.data` å’Œ `encrypted.proof`
- æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—

### 2. ä¿®å¤ `Lobby.tsx` (åŠ å…¥æ¸¸æˆåŠŸèƒ½)

**æ–‡ä»¶**: `frontend/src/pages/Lobby.tsx` (ç¬¬ 259-292 è¡Œ)

**ä¿®æ”¹**:
- ç§»é™¤äº† hex å­—ç¬¦ä¸²è½¬æ¢
- ç›´æ¥ä¼ é€’ `encrypted.data` å’Œ `encrypted.proof`
- æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

æ ¹æ® `dev.md` çš„ "Input" éƒ¨åˆ†ï¼ˆç¬¬ 4000-4053 è¡Œï¼‰ï¼š

```typescript
// å‰ç«¯åŠ å¯†
const buffer = instance.createEncryptedInput(contractAddress, userAddress);
buffer.add64(BigInt(23393893233));
const ciphertexts = await buffer.encrypt();

// å‰ç«¯è°ƒç”¨åˆçº¦ - ç›´æ¥ä¼ é€’ handles[0] å’Œ inputProof
my_contract.add(
  ciphertexts.handles[0],      // âœ… ç›´æ¥ä¼ é€’ï¼Œä¸è½¬æ¢
  ciphertexts.handles[1],      // âœ… ç›´æ¥ä¼ é€’ï¼Œä¸è½¬æ¢
  ciphertexts.inputProof,      // âœ… ç›´æ¥ä¼ é€’ï¼Œä¸è½¬æ¢
);
```

---

## ğŸ¯ ç°åœ¨åº”è¯¥åšä»€ä¹ˆ

### 1. åˆ·æ–°å‰ç«¯é¡µé¢

å‰ç«¯ä»£ç å·²ç»ä¿®å¤ï¼Œå¼€å‘æœåŠ¡å™¨ä¼šè‡ªåŠ¨é‡æ–°ç¼–è¯‘ã€‚

```
æŒ‰ F5 æˆ– Cmd+R åˆ·æ–°é¡µé¢
```

### 2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

```
æŒ‰ Ctrl+Shift+Delete (æˆ– Cmd+Shift+Delete)
é€‰æ‹© "æ‰€æœ‰æ—¶é—´"
æ¸…é™¤ç¼“å­˜
```

### 3. é‡æ–°è¿æ¥é’±åŒ…

```
æ–­å¼€é’±åŒ…è¿æ¥
é‡æ–°è¿æ¥
```

### 4. æµ‹è¯•æ¸¸æˆ

```
1. è¿›å…¥å¤§å…
2. åˆ›å»ºæˆ–åŠ å…¥æ¸¸æˆ
3. å°è¯•åŠ æ³¨ âœ… åº”è¯¥æˆåŠŸ
4. å°è¯•ç¦»å¼€æ¸¸æˆ âœ… åº”è¯¥æˆåŠŸ
```

---

## ğŸ“Š ä¿®å¤å‰åå¯¹æ¯”

| é¡¹ç›® | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| æ•°æ®æ ¼å¼ | âŒ hex å­—ç¬¦ä¸² | âœ… åŸå§‹ handles |
| åŠ æ³¨åŠŸèƒ½ | âŒ å¤±è´¥ (0x9de3392c) | âœ… æˆåŠŸ |
| ç¦»å¼€æ¸¸æˆ | âŒ å¤±è´¥ (0x9de3392c) | âœ… æˆåŠŸ |
| åŠ å…¥æ¸¸æˆ | âŒ å¯èƒ½å¤±è´¥ | âœ… æˆåŠŸ |

---

## ğŸ§ª éªŒè¯ä¿®å¤

### æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°

æ‰“å¼€ F12ï¼ŒæŸ¥æ‰¾ä»¥ä¸‹æ—¥å¿—ï¼š

```
âœ… åŠ å¯†å®Œæˆ: {
  dataType: "object",
  dataLength: 32,
  proofLength: 128,
  dataValue: Uint8Array(...),
  proofValue: Uint8Array(...)
}

ğŸ“ è°ƒç”¨åˆçº¦ bet å‡½æ•°: {
  address: "0x49871B66FEAfe19F60373000876Bb9c23b1ca39d",
  functionName: "bet",
  args: [0n, Uint8Array(...), Uint8Array(...)],
  dataType: "object",
  proofType: "object"
}
```

### é¢„æœŸç»“æœ

- âœ… åŠ æ³¨æˆåŠŸ
- âœ… ç¦»å¼€æ¸¸æˆæˆåŠŸ
- âœ… åŠ å…¥æ¸¸æˆæˆåŠŸ
- âœ… ä¸å†å‡ºç°é”™è¯¯ `0x9de3392c`

---

## ğŸ’¡ å…³é”®å­¦ä¹ 

**é‡è¦**: ä¸è¦éšæ„è½¬æ¢ FHEVM è¿”å›çš„åŠ å¯†æ•°æ®ï¼

- âŒ ä¸è¦è½¬æ¢ä¸º hex å­—ç¬¦ä¸²
- âŒ ä¸è¦è½¬æ¢ä¸º JSON
- âœ… ç›´æ¥ä¼ é€’åŸå§‹æ•°æ®

FHEVM åº“ä¼šè‡ªåŠ¨å¤„ç†åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚

---

## ğŸ“ æ€»ç»“

é—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯**å‰ç«¯åœ¨å¤„ç†åŠ å¯†æ•°æ®æ—¶è¿›è¡Œäº†ä¸å¿…è¦çš„è½¬æ¢**ï¼Œè¿™ç ´åäº†æ•°æ®æ ¼å¼ï¼Œå¯¼è‡´åˆçº¦ä¸­çš„ `FHE.fromExternal()` éªŒè¯å¤±è´¥ã€‚

é€šè¿‡éµå¾ª `dev.md` æ–‡æ¡£ä¸­çš„æ­£ç¡®åšæ³•ï¼Œç›´æ¥ä¼ é€’åŠ å¯†æ•°æ®ï¼Œé—®é¢˜å·²ç»è§£å†³ã€‚


